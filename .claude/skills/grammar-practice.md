# 文法練習生成與批改

此 skill 用於根據文法筆記生成選擇題練習，並在用戶作答後進行批改。

## 使用時機

當用戶說：
- 「出 N3 文法題」
- 「練習 ch1 的文法」
- 「出 5 題 ep49 的文法練習」

## 工作流程

### Step 1: 讀取文法來源

根據用戶指定的範圍，讀取對應的 CSV 檔案：

```
Grammar/N3/N3 - ch1.csv   → ch1
Grammar/N3/N3 - ch2.csv   → ch2
Grammar/N3/N3 - ep49.csv  → ep49
```

若檔案過大，使用 `limit` 參數讀取前 20-50 行以獲取足夠的文法點。

### Step 2: 出題規則

從讀取的文法中，生成 **5 題選擇題**（可依用戶要求調整數量）。

#### 題型設計原則

1. **填空題**：在句子中挖空，讓用戶選擇正確的文法
2. **選項設計**：
   - 1 個正解
   - 3 個干擾選項（相似但不正確的用法）
3. **考點分布**：
   - `〜合う` vs 單向動詞
   - `〜上がる`（自動詞）vs `〜上げる`（他動詞）
   - 助詞搭配（が vs を）
   - 其他 CSV 中的文法點

#### 題目範例

```markdown
### 第1題
その問題について、部長と（　　）必要があります。

1. 話す
2. 話し合う
3. 話される
4. 話してあげる

**我的答案：**
```

### Step 3: 建立練習檔案

在 `Practice/` 資料夾創建檔案：

**命名格式：** `YYYY-MM-DD_N[等級]_[來源].md`

**範例：** `Practice/2026-01-12_N3_ch1.md`

**檔案結構：**

```markdown
# N3 文法練習 - [來源]
**日期：YYYY-MM-DD**
**範圍：[文法範圍說明]**

---

## 請選擇正確的答案填入括號中

### 第1題
[題目內容]

1. [選項1]
2. [選項2]
3. [選項3]
4. [選項4]

**我的答案：**

---

[重複 5 題]

---

## 作答完成後告訴我，我會幫你批改！
```

### Step 4: 等待用戶作答

告知用戶：
- 檔案位置
- 題目範圍
- 作答方式（填入數字 1-4）

用戶可以：
- 直接在對話中回覆答案（如「1, 2, 2, 3, 3」）
- 在檔案中填寫後告知

### Step 5: 批改與解析

收到用戶答案後，進行批改並**更新練習檔案**。

#### 批改後的檔案格式

```markdown
# N3 文法練習 - [來源]
**日期：YYYY-MM-DD**
**範圍：[文法範圍說明]**
**成績：X/5**

---

## 題目與批改

### 第1題 ✓ 或 ❌
[原題目]

1. 選項1
2. **選項2** ← 正解
3. 選項3
4. 選項4

**我的答案：[用戶答案]**

**正解句：**
> 漢字[讀音]標記的完整句子

**翻譯：** 中文翻譯

**解析：** 為什麼這個答案正確，其他選項為什麼錯誤

---

[重複所有題目]

---

## 重點整理

| 文法 | 意思 | 重點 |
|:---|:---|:---|
| 文法1 | 意思 | 使用要點 |
| 文法2 | 意思 | 使用要點 |
```

#### 漢字標記規則

使用振假名格式：`漢字[讀音]`

```
正確：その 問題[もんだい]について、部長[ぶちょう]と 話[はな]し合[あ]う
錯誤：その問題について、部長と話し合う
```

### Step 6: 回報成績

批改完成後，向用戶回報：
- 得分（如 3/5）
- 錯題的重點提示
- 詢問是否繼續練習

## 重要規則

### 出題規則
- 每題只考一個文法點
- 選項之間要有明確區別
- 干擾選項要合理（不能太離譜）
- 優先考察容易混淆的文法（自他動詞、助詞搭配）

### 批改規則
- 必須包含漢字標記（振假名）
- 必須包含中文翻譯
- 解析要說明「為什麼對」和「為什麼錯」
- 最後要有重點整理表格

### 檔案規則
- 練習檔案放在 `Practice/` 資料夾
- 檔名包含日期，方便追蹤
- 批改後直接更新原檔案（不另建新檔）

## 範例對話流程

**用戶：** 練習 ch1 的文法

**Claude：**
1. 讀取 `Grammar/N3/N3 - ch1.csv`
2. 生成 5 題選擇題
3. 建立 `Practice/2026-01-12_N3_ch1.md`
4. 告知用戶開始作答

**用戶：** 1, 2, 2, 3, 3

**Claude：**
1. 批改答案
2. 更新檔案加入翻譯、漢字標記、解析
3. 回報成績
4. 詢問是否繼續

## 輸出檔案位置

```
nihongo_cc/
└── Practice/
    └── YYYY-MM-DD_N[等級]_[來源].md
```
